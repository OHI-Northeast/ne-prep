---
title: 'OHI-Northeast: New Hampshire Coastal Access'
author: "*Compiled on `r date()` by `r Sys.info()['user']`*"
output: 
  html_document:
    code_folding: show
    toc: true
    toc_depth: 3
    toc_float: yes
    number_sections: false
    theme: cerulean
    highlight: haddock
    includes: 
      in_header: '~/github/ne-prep/src/templates/ohi_hdr.html'
  pdf_document:
    toc: true
---

``` {r setup,  message = FALSE, warning = FALSE}
knitr::opts_chunk$set(fig.width = 6, fig.height = 4, fig.path = 'figs/',
                      message = FALSE, warning = FALSE)

source('~/github/ne-prep/src/R/common.R')  ### an OHINE specific version of common.R

dir_git <- '~/github/ne-prep'
dir_anx <- file.path(dir_M, 'git-annex/neprep')

#libraries
library(tidyverse)
```

  
#Methods

## Load Data

Inland buffer

We are going to use the 1 mile inland buffer as well as the rgns to identify coastal points. 
```{r}
inland_buffer <- read_sf("~/github/ne-prep/spatial/shapefiles/ohine_inland_1km.shp") %>%
  filter(rgn_name == "New Hampshire") %>%
  select(rgn_name, rgn_id)
```

Combine inland buffer with connecticut state waters

```{r}
nh_shape <- rgns %>%
  filter(rgn_name == "New Hampshire") %>%
  select(rgn_name, rgn_id) %>%
  rbind(inland_buffer)
```


### New Hampshire 2016

**Socioeconomic Point Layer**

CODES
A - AIRPORT
AV - ABANDONED VESSEL
B - BEACH
C - CAMPGROUND
RE - RENEWABLE ENERGY
HWR  HISTORICAL WRECK
HP - HELIPORT
NOAA - NOAA FACILITY
EPAF - EPA FACILITY

```{r}
nh_2016_soc <- st_read(dsn=file.path(dir_anx, "_raw_data/NOAA_ESI/ME_NH_2016_GDB/Maine_NewHampshire_2016_ESI.gdb"), layer = "SOCECON_POINT") %>%
  st_transform(us_alb) %>%
  st_intersection(nh_shape) %>%
  mutate(TYPE = as.character(TYPE)) %>%
  filter(TYPE %in% c("B", "C")) %>%
  select(TYPE, rgn_name, rgn_id) %>%
  mutate(year = 2016)
```

**Navigational Marine Point layer**

CODES
A2 - ACCESS POINT
BR - BOAT RAMP
LD - LOCK AND DAM
M - MARINA
PT - PORT
RM - RM

```{r}
nh_2016_nav <- st_read(dsn=file.path(dir_anx, "_raw_data/NOAA_ESI/ME_NH_2016_GDB/Maine_NewHampshire_2016_ESI.gdb"), layer = "NAV_MARINE_POINT") %>%
  st_transform(us_alb) %>%
  st_intersection(nh_shape) %>%
  mutate(TYPE = as.character(TYPE)) %>%
  filter(TYPE %in% c("A2", "BR", "M", "PT")) %>%
  select(TYPE, rgn_name, rgn_id) %>%
  mutate(year = 2016)
```

**Managed Point layer**
CODES
NL = National Landmark
NG = National Guard


```{r}
nh_2016_mgd <- st_read(dsn=file.path(dir_anx, "_raw_data/NOAA_ESI/ME_NH_2016_GDB/Maine_NewHampshire_2016_ESI.gdb"), layer = "MANAGED_POINT") %>%
  st_transform(us_alb) %>%
  st_intersection(nh_shape) %>%
  mutate(TYPE = as.character(TYPE)) %>%
  filter(TYPE == "NL") %>%
  select(TYPE, rgn_name, rgn_id) %>%
  mutate(year = 2016)
```

Combine the layers

```{r}
nh_2016 <- nh_2016_nav %>%
  rbind(nh_2016_mgd) %>%
  rbind(nh_2016_soc)
```

----

Lets look at the 2016 points

```{r}
library(mapview)
mapview(nh_2016, zcol = "TYPE")
```







